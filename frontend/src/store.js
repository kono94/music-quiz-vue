import Vue from 'vue';
import Vuex from 'vuex';
import { SET_ROOM, SET_SOCKET_STATE, SET_USER } from './mutation-types';

Vue.use(Vuex);

export default new Vuex.Store({
  state: {
    socketConnected: false,
    room: null,
    player: {
      username: 'autoGenerated',
    },
  },
  mutations: {
    [SET_USER](state, payload) {
      this.state.player = payload;
      if (this.state.player.roomID == null){
        this.state.room = null;
      }
    },
    [SET_ROOM](state, payload) {
      this.state.room = payload;
    },
    [SET_SOCKET_STATE](state, payload) {
      this.state.socketConnected = payload.isConnected;
    },
  },
  actions: {

  },
  getters: {
    room: state => (state.room ? state.room : null),
    sessionID: state => state.player.sessionID,
    username: state => state.player.username,
    isSocketConnected: state => state.socketConnected,
    isRoomRunning: state => (state.room ? state.room.running : false),
  },
});
